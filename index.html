<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The South Indian Table | Authentic Meal Plans</title>
    <link rel="icon" type="image/png" href="Favicon Logo.png">
    <meta name="description" content="Authentic South Indian Meal Plans delivered to your door in Milton Keynes. Fresh, homemade, and healthy.">
    <meta property="og:title" content="RicePot UK | Authentic South Indian Meals">
    <meta property="og:url" content="https://ricepot.co.uk">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background-color: #f9fafb; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-btn.active { border-bottom: 4px solid #ea580c; color: #ea580c; }
        #subModal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 100; align-items: center; justify-content: center; padding: 20px; }
        #subModal.active { display: flex; }
        .step { display: none; }
        .step.active { display: block; }
        .choice-btn { border: 2px solid #e5e7eb; transition: 0.2s; width: 100%; padding: 1.25rem; border-radius: 16px; font-weight: 600; text-align: left; margin-bottom: 12px; }
        .choice-btn:hover { border-color: #ea580c; background-color: #fff7ed; transform: translateX(5px); }
        .hero-bg { background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.pexels.com/photos/2474661/pexels-photo-2474661.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2'); background-size: cover; background-position: center; min-height: 65vh; display: flex; align-items: center; }
        .deadline-ticker { background: #fee2e2; color: #991b1b; padding: 10px; border-radius: 12px; font-weight: bold; font-size: 0.8rem; margin-bottom: 20px; display: inline-block; }
        .discount-badge { display: none; color: #15803d; font-weight: bold; font-size: 0.8rem; margin-top: 5px; }
    </style>
</head>
<body>

    <div class="bg-gray-900 text-white py-2 px-4 text-center text-[10px] md:text-sm font-bold uppercase tracking-wide flex justify-center items-center gap-3">
        üéÅ <span class="text-orange-400">DOUBLE REWARD:</span> Friends get 25% OFF. You get <span class="text-green-400">1 WEEK FREE!</span>
        <button onclick="shareViaWhatsApp()" class="bg-green-600 px-3 py-1 rounded-full text-[9px] hover:bg-green-700">Invite Friends</button>
    </div>

    <nav class="bg-white py-4 shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-orange-600">The South Indian Table</h1>
            <div class="hidden md:flex space-x-8 items-center text-sm font-bold">
                <a href="#about" class="hover:text-orange-600">About</a>
                <a href="#menu-section" class="hover:text-orange-600">Menu</a>
                <a href="#plans" class="bg-orange-600 text-white px-6 py-2 rounded-full shadow-lg">Subscribe Now</a>
            </div>
        </div>
    </nav>

    <section id="about" class="hero-bg text-white px-6 text-center">
        <div class="max-w-4xl mx-auto">
            <div id="deadlineTimer" class="deadline-ticker">‚è≥ Calculating...</div>
            <h2 class="text-4xl md:text-6xl font-bold mb-6">Authentic South Indian Meals</h2>
            <p class="text-lg text-gray-200 mb-10">Traditional recipes. Zero additives. Truly homemade.</p>
            <a href="#plans" class="bg-orange-600 px-10 py-4 rounded-xl font-bold shadow-xl inline-block">Browse Plans</a>
        </div>
    </section>

    <section id="menu-section" class="py-16 bg-gray-50 text-center">
        <div class="container mx-auto px-4">
            <h2 class="text-2xl font-bold mb-8 text-gray-800">Weekly Menu Cycle</h2>
            <div class="flex justify-center gap-4 mb-10 overflow-x-auto pb-2">
                <button class="tab-btn active px-6 py-2 font-bold whitespace-nowrap" onclick="openWeek(event, 'w1')">Week 1</button>
                <button class="tab-btn px-6 py-2 font-bold whitespace-nowrap" onclick="openWeek(event, 'w2')">Week 2</button>
                <button class="tab-btn px-6 py-2 font-bold whitespace-nowrap" onclick="openWeek(event, 'w3')">Week 3</button>
                <button class="tab-btn px-6 py-2 font-bold whitespace-nowrap" onclick="openWeek(event, 'w4')">Week 4</button>
            </div>
            <div id="w1" class="tab-content active grid sm:grid-cols-2 lg:grid-cols-4 gap-6 text-left"></div>
            <div id="w2" class="tab-content grid sm:grid-cols-2 lg:grid-cols-4 gap-6 text-left"></div>
            <div id="w3" class="tab-content grid sm:grid-cols-2 lg:grid-cols-4 gap-6 text-left"></div>
            <div id="w4" class="tab-content grid sm:grid-cols-2 lg:grid-cols-4 gap-6 text-left"></div>
        </div>
    </section>

    <section id="plans" class="py-12 container mx-auto px-4 text-center">
        <h2 class="text-3xl font-bold mb-6">Subscription Plans</h2>
        <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
            <div class="bg-white p-8 rounded-3xl shadow-xl border flex flex-col">
                <h3 class="text-2xl font-bold">5-Day Plan</h3>
                <p class="text-orange-600 font-bold my-4">From ¬£30/week</p>
                <button onclick="startSubscription('5-Day')" class="mt-auto bg-orange-600 text-white py-4 rounded-xl font-bold">Subscribe</button>
            </div>
            <div class="bg-white p-8 rounded-3xl shadow-xl border flex flex-col">
                <h3 class="text-2xl font-bold">7-Day Plan</h3>
                <p class="text-green-700 font-bold my-4">From ¬£42/week</p>
                <button onclick="startSubscription('7-Day')" class="mt-auto bg-green-700 text-white py-4 rounded-xl font-bold">Subscribe</button>
            </div>
        </div>
    </section>

    <div id="subModal">
        <div class="bg-white w-full max-w-lg rounded-3xl p-8 shadow-2xl relative overflow-y-auto max-h-[90vh]">
            <button onclick="closeModal()" class="absolute top-5 right-5 text-gray-400 text-2xl">&times;</button>
            <div id="modalBody">
                <div id="step1" class="step active"><p class="font-bold mb-4">Preference</p><button class="choice-btn" onclick="selectStep(1, 'preference', 'Vegetarian')">ü•¶ Vegetarian</button><button class="choice-btn" onclick="selectStep(1, 'preference', 'Non-Veg')">üçó Non-Veg</button></div>
                <div id="step2" class="step"><p class="font-bold mb-4">Meal Type</p><button class="choice-btn" onclick="selectStep(2, 'mealType', 'Lunch Only')">‚òÄÔ∏è Lunch Only</button><button class="choice-btn" onclick="selectStep(2, 'mealType', 'Dinner Only')">üåô Dinner Only</button><button class="choice-btn" onclick="selectStep(2, 'mealType', 'Both')">üç± Both</button></div>
                <div id="step3" class="step"><p class="font-bold mb-4">Service</p><button class="choice-btn" onclick="selectStep(3, 'service', 'Collection')">ü•° Collection</button><button class="choice-btn" onclick="selectStep(3, 'service', 'Delivery')">üöö Delivery</button></div>
                <div id="step4" class="step"><p class="font-bold mb-4">Delivery Frequency</p><button class="choice-btn" onclick="selectStep(4, 'logic', 'Together')">üì¶ Together</button><button class="choice-btn" onclick="selectStep(4, 'logic', 'Individual')">üèéÔ∏è Individual</button></div>
                <div id="stepFinal" class="step">
                    <div class="bg-gray-100 p-6 rounded-2xl text-center mb-6 border-2 border-orange-500">
                        <h4 class="text-4xl font-black" id="displayPrice">¬£0</h4>
                        <p id="discountMsg" class="discount-badge">‚úÖ 25% Friend Referral Applied!</p>
                    </div>
                    <form id="finalSubForm" class="space-y-4">
                        <input type="hidden" name="planDuration" id="hiddenPlan"><input type="hidden" name="preference" id="hiddenPref"><input type="hidden" name="mealType" id="hiddenMeal"><input type="hidden" name="service" id="hiddenService"><input type="hidden" name="logic" id="hiddenLogic"><input type="hidden" name="finalPrice" id="hiddenPrice">
                        <input type="text" name="name" id="userName" placeholder="Full Name" required class="w-full p-4 border rounded-xl outline-none">
                        <input type="tel" name="mobile" placeholder="Mobile" required class="w-full p-4 border rounded-xl outline-none">
                        <input type="email" name="email" placeholder="Email" required class="w-full p-4 border rounded-xl outline-none">
                        
                        <div id="postcodeArea" style="display:none;">
                            <input type="text" id="pcInput" name="postcode" placeholder="Postcode (MK9/MK6)" oninput="validatePostcode()" class="w-full p-4 border rounded-xl outline-none uppercase font-bold">
                        </div>

                        <input type="text" id="refCodeInput" name="referrerInfo" placeholder="Friend's Referral Code" oninput="showFinal()" class="w-full p-4 border rounded-xl outline-none uppercase">
                        <textarea name="instructions" placeholder="Address & Special Instructions..." required class="w-full p-4 border rounded-xl h-24"></textarea>
                        
                        <button type="submit" id="submitBtn" class="w-full bg-orange-600 text-white py-5 rounded-xl font-bold shadow-xl">Confirm & Subscribe</button>
                    </form>
                </div>
            </div>
            
            <div id="successContent" class="hidden text-center py-10 px-4">
                <div class="text-6xl mb-6">üçõ</div>
                <h3 class="text-3xl font-bold mb-2 text-orange-600">You're All Set!</h3>
                <p class="text-gray-600 mb-4 font-medium">Welcome to The South Indian Table family.</p>
                <p class="text-sm text-gray-500 mb-8">We've sent a confirmation email with your order details and your unique referral code. Get ready for some authentic flavors!</p>
                
                <button id="successWaBtn" onclick="shareViaWhatsApp()" class="w-full bg-[#25D366] text-white py-4 rounded-xl font-bold mb-4 hover:opacity-90 transition">Invite Friends via WhatsApp</button>
                
                <button onclick="location.reload()" class="w-full bg-gray-900 text-white py-4 rounded-xl font-bold hover:bg-black transition">Return to Home</button>
            </div>
        </div>
    </div>

    <footer class="bg-white py-12 border-t text-center">
        <p class="text-[10px] text-gray-400 mt-8">&copy; 2026 The South Indian Table. A <b>friesnrice</b> brand.</p>
    </footer>

    <script>
        const webAppUrl = 'https://script.google.com/macros/s/AKfycbx9-54BQlb601TlynZVi28OsD3fditc9emkLygD4lFeyUAbx8n_5flRapaUv63wNk3-/exec';
        let subData = { planDuration: '', preference: '', mealType: '', service: '', logic: 'N/A' }, allowedPostcodes = [], validReferralCodes = [], currentStepNum = 1;
        const prices = { "5-Day": { "Vegetarian": { "Lunch Only": { "Collection": 30, "Delivery": 35 }, "Dinner Only": { "Collection": 30, "Delivery": 35 }, "Both": { "Collection": 50, "Delivery": { "Together": 55, "Individual": 60 } } }, "Non-Veg": { "Lunch Only": { "Collection": 32, "Delivery": 37 }, "Dinner Only": { "Collection": 32, "Delivery": 37 }, "Both": { "Collection": 54, "Delivery": { "Together": 59, "Individual": 64 } } } }, "7-Day": { "Vegetarian": { "Lunch Only": { "Collection": 42, "Delivery": 49 }, "Dinner Only": { "Collection": 42, "Delivery": 49 }, "Both": { "Collection": 70, "Delivery": { "Together": 77, "Individual": 85 } } }, "Non-Veg": { "Lunch Only": { "Collection": 45, "Delivery": 53 }, "Dinner Only": { "Collection": 45, "Delivery": 53 }, "Both": { "Collection": 75, "Delivery": { "Together": 85, "Individual": 90 } } } } };
        
        // UPDATED: Now uses ricepot.co.uk
        function shareViaWhatsApp() {
            const code = "YOUR_CODE"; 
            const msg = `Hey I am loving the meals from South Indian Table. Use code ${code} to get a 25% off on your first week and sign up here: https://ricepot.co.uk`;
            window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, '_blank');
        }

        function updateDeadline() { const now = new Date(); const d = new Date(); d.setHours(22,0,0,0); if (now > d) document.getElementById('deadlineTimer').innerHTML = "üõë Orders Closed for Tomorrow"; else document.getElementById('deadlineTimer').innerHTML = `‚è±Ô∏è Order within <b>${Math.floor((d-now)/3600000)}h ${Math.floor(((d-now)%3600000)/60000)}m</b> for tomorrow.`; }
        function startSubscription(dur) { subData.planDuration = dur; document.getElementById('subModal').classList.add('active'); showStep(1); }
        function closeModal() { document.getElementById('subModal').classList.remove('active'); }
        function openWeek(e, w) { document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none'); document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); document.getElementById(w).style.display = 'grid'; e.currentTarget.classList.add('active'); }
        function showStep(n) { currentStepNum = n; document.querySelectorAll('.step').forEach(s => s.classList.remove('active')); document.getElementById(n === 'Final' ? 'stepFinal' : 'step'+n).classList.add('active'); }
        function selectStep(step, key, val) { subData[key] = val; if (step < 3) showStep(step+1); else if (step === 3) (subData.mealType === 'Both' && subData.service === 'Delivery') ? showStep(4) : showFinal(); else showFinal(); }
        
        function validatePostcode() {
            if (subData.service !== 'Delivery') return;
            const input = document.getElementById('pcInput').value.toUpperCase().trim();
            const btn = document.getElementById('submitBtn');
            if (input.length >= 2) {
                const isValid = allowedPostcodes.some(pc => input.startsWith(pc));
                btn.disabled = !isValid;
                btn.style.opacity = !isValid ? '0.5' : '1';
                btn.innerText = !isValid ? 'Delivery Unavailable in Area' : 'Confirm & Subscribe';
            }
        }

        function showFinal() { 
            let p = prices[subData.planDuration][subData.preference][subData.mealType][subData.service];
            if (typeof p === 'object') p = p[subData.logic];
            const refCode = document.getElementById('refCodeInput').value.toUpperCase().trim();
            if (refCode && validReferralCodes.includes(refCode)) { p = (p * 0.75).toFixed(2); document.getElementById('discountMsg').style.display = 'block'; } else { document.getElementById('discountMsg').style.display = 'none'; }
            document.getElementById('displayPrice').innerText = `¬£${p}`;
            document.getElementById('hiddenPlan').value = subData.planDuration; document.getElementById('hiddenPref').value = subData.preference; document.getElementById('hiddenMeal').value = subData.mealType; document.getElementById('hiddenService').value = subData.service; document.getElementById('hiddenLogic').value = subData.logic; document.getElementById('hiddenPrice').value = p;
            document.getElementById('postcodeArea').style.display = (subData.service === 'Delivery') ? 'block' : 'none';
            showStep('Final'); validatePostcode();
        }

        document.getElementById('finalSubForm').addEventListener('submit', function(e) { e.preventDefault(); const btn = document.getElementById('submitBtn'); btn.innerHTML = "Processing..."; btn.disabled = true; fetch(webAppUrl, { method: 'POST', body: new FormData(this) }).then(() => { document.getElementById('modalBody').classList.add('hidden'); document.getElementById('successContent').classList.remove('hidden'); }); });
        
        window.onload = function() { 
            updateDeadline(); setInterval(updateDeadline, 60000); 
            fetch(webAppUrl).then(r => r.json()).then(res => { 
                allowedPostcodes = res.allowedPostcodes; 
                validReferralCodes = res.validReferralCodes;
                const days = ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY', 'SUNDAY'];
                days.forEach(day => { 
                    if (res.menu[day]) {
                        for(let w=1; w<=4; w++) {
                            document.getElementById('w'+w).innerHTML += `<div class="bg-white p-5 rounded-2xl border"><p class="text-[10px] text-gray-400 uppercase">${day}</p><p class="text-xs mt-2"><b>L:</b> ${res.menu[day]['w'+w].lunch}</p><p class="text-xs"><b>D:</b> ${res.menu[day]['w'+w].dinner}</p></div>`;
                        }
                    }
                }); 
            }); 
        };
    </script>
</body>
</html>


